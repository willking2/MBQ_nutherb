{
    "contents" : "##### MBQ nutrients and herbivory analysis\n##### Experiment A\n##### GREX Moorea Winer 2014\n\n\n########### summer 2015 analyses (took QSCI 482, 483)\nExpA <- read.csv(file.choose(), header = T)\n\n# remove missing data\nExpA.na.omit <- na.omit(ExpA)\n\nplot(ExpA) # not helpful\nqqnorm(ExpA$chg_mass) # looks pretty good..\n\nExpA$cage <- as.factor(ExpA$cage)\nExpA$sed_nut <- as.factor(ExpA$sed_nut)\nExpA$watercol_nut <- as.factor(ExpA$watercol_nut)\n\n\n#full linear, normal model \n# not weighted.. should it be?\nmodelA.1 <- aov(chg_mass ~ cage + sed_nut + watercol_nut + cage:sed_nut + cage:watercol_nut + sed_nut:watercol_nut + cage:sed_nut:watercol_nut, data = ExpA)\nmodel.matrix(modelA.1)\nsummary(modelA.1)\nanova(modelA.1) # signifcant three way interaction\n\n\nmodelA.2 <- aov(chg_mass ~ trt, data = ExpA)\nmodel.matrix(modelA.1)\nsummary(modelA.2)\nanova(modelA.2)\n\n# studentized deleted residuals vs. model fits\nplot(modelA.1$fit, rstudent(modelA.1), xlab = \"model fit\", ylab = \"studentized deleted residuals\", ylim = c(-3,3))\nabline(h=0, lty=2)\nabline(h=-2, lty=2)\nabline(h=2, lty=2)\n## looks like there might be 2 or 3 outliers? \nboxplot(rstudent(modelA.1))\n\n## check for levereage points\n# calculate differences between fitted values\nDFFITS <- dffits(modelA.1)\nDFFITS[DFFITS >1] # no values > 1, no leverage points\n\n# cooks distances and corresponding p-values\ncooks <- cooks.distance(modelA.1)\ncooks[cooks >1]\ncooks_pval <- pf(cooks, df1=8, df2=54, lower.tail=F) #df1 = number of parameters fitted, df2 = sample size - df1\ncooks_pval[cooks_pval < 0.05] # no interesting/significant leverage points\n\n# DFBETAS\nDFBETAS <- dfbetas(modelA.1) \nDFBETAS[DFBETAS >1] # no leverage points\n\n##### test for model appropriate-ness\n## shapiro-wilks for departure from normality\nshapiro.test(ExpA$chg_mass) # p = 0.7811, response var seems to be normally dist.\n\n# interaction plots\n#caged data\nExpA_caged <- subset(ExpA.na.omit, ExpA$cage == 1)\n# caged plot\ninteraction.plot(ExpA_caged$sed_nut, ExpA_caged$watercol_nut, ExpA_caged$chg_mass, \n                 fun = mean,\n                 type = c(\"l\"), \n                 legend = FALSE,\n                 trace.label = \"water column nut\",\n                 fixed = TRUE,\n                 xlab = \"sediment nut\",\n                 ylab = \"change in mass (g)\",\n                 ylim = c(0, 4),\n                 main = \"caged\"\n                 )\nlegend(x = \"bottomright\", legend = c(\"0\", \"1\"), lty = c(2, 1), title = \"water col nut\", bty = \"o\", horiz = TRUE, y.intersp = 0.75)\n# uncaged data\nExpA_uncaged <- subset(ExpA.na.omit, ExpA$cage == 0)\n#uncaged plot\ninteraction.plot(ExpA_uncaged$sed_nut, ExpA_uncaged$watercol_nut, ExpA_uncaged$chg_mass,\n                 fun = mean,\n                 type = c(\"l\"), \n                 legend = FALSE,\n                 trace.label = \"water column nut\",\n                 fixed = TRUE,\n                 xlab = \"sediment nut\",\n                 ylab = \"change in mass (g)\",\n                 ylim = c(0, 4),\n                 main = \"uncaged\"\n                 )\nlegend(x = \"topright\", legend = c(\"0\", \"1\"), lty = c(2, 1), title = \"water col nut\", bty = \"o\", horiz = TRUE, y.intersp = 0.75)\n\n## multiple comparisons\nTukeyHSD(modelA.1, \"cage:sed_nut:watercol_nut\", ordered = FALSE, conf.level = 0.95)\nplot(TukeyHSD(modelA.1, \"cage\"))\nplot(TukeyHSD(modelA.1, \"sed_nut\"))\nplot(TukeyHSD(modelA.1, \"watercol_nut\"))\nplot(TukeyHSD(modelA.1, \"cage:watercol_nut\"))\nplot(TukeyHSD(modelA.1, \"cage:sed_nut\"))\nplot(TukeyHSD(modelA.1, \"sed_nut:watercol_nut\"))\nplot(TukeyHSD(modelA.1, \"cage:sed_nut:watercol_nut\"))\n\nTukeyHSD(modelA.2, \"trt\", ordered = FALSE, conf.level = 0.95)\nplot(TukeyHSD(modelA.2, \"trt\"))\n\n\n#############################################################################\n######### old analyses... (only took QSCI482) see below\n## name data table\nExpA <- ExpA_grugosa_masses\nExpA\n\n## remove two rows of missing data (lost OSW treatments)\nExpA <- ExpA[-c(39,40), ]\nExpA\n\n## residuals\nr1 <- lm(ExpA$chg_mass ~ ExpA$trt)\nresid(r1)\nqqnorm(resid(r1))\nqqline(resid(r1))                       # qq plot of residuals appears leptokurtic\n# histogram\nhist(resid(r1))                         # histogram of residuals appears left skewed\n# residual vs. chg_mass\nplot(resid(r1) ~ ExpA$chg_mass)\n\n\n## transform to equalize variances\nExpA$trans_chg_mass <- 1/(ExpA$chg_mass)\n\n## box plots\nplot(trans_chg_mass ~ trt, data = ExpA)\n\n## Fligner-Killeen test of homogeneity of variances\nfligner.test(trans_chg_mass ~ interaction(cage, sed_nut, watercol_nut), data = ExpA)\n\n\n################# bar plotting -- doesn't work yet -- #######################\n# find means by treatment\nmean_chg <- aggregate(ExpA[ ,7], list(Treatment=ExpA$trt), mean)\n\n# bar plot of means of chg in mass (not percent change)\n# specify x-axis order\nx1 <- factor(ExpA$trt, levels = c())\n\n#plot\nbarplot(mean_chg$x, ylab = \"Mean change in G. rugosa mass (g over 8 days)\", xlab = \"Treatment\")\n",
    "created" : 1427207961537.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4281455450",
    "id" : "E6518AB3",
    "lastKnownWriteTime" : 1434585260,
    "path" : "~/UCLA/2014 winter FMBQ/MBQ/MBQ_nutherb/analyses/MBQ_nutherb_analyses/ExpA_analysis.R",
    "project_path" : "ExpA_analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}